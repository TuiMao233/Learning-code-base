<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nodejs 服务端CV8框架 | Mr.Mao&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" type="image/x-icon" href="/mao-blog/favicon.ico">
    <meta name="description" content="For man is man and master of his fate.">
    
    <link rel="preload" href="/mao-blog/assets/css/0.styles.c7f09f7b.css" as="style"><link rel="preload" href="/mao-blog/assets/js/app.19e1b50c.js" as="script"><link rel="preload" href="/mao-blog/assets/js/4.512e8a4d.js" as="script"><link rel="preload" href="/mao-blog/assets/js/1.6b005ada.js" as="script"><link rel="preload" href="/mao-blog/assets/js/29.c4272f05.js" as="script"><link rel="prefetch" href="/mao-blog/assets/js/10.8008c15a.js"><link rel="prefetch" href="/mao-blog/assets/js/11.e6d5e627.js"><link rel="prefetch" href="/mao-blog/assets/js/12.5df4cc14.js"><link rel="prefetch" href="/mao-blog/assets/js/13.64a3b0dc.js"><link rel="prefetch" href="/mao-blog/assets/js/14.92c69349.js"><link rel="prefetch" href="/mao-blog/assets/js/15.fcb00b5c.js"><link rel="prefetch" href="/mao-blog/assets/js/16.177fc3f8.js"><link rel="prefetch" href="/mao-blog/assets/js/17.35b5192e.js"><link rel="prefetch" href="/mao-blog/assets/js/18.4059f020.js"><link rel="prefetch" href="/mao-blog/assets/js/19.d0f23759.js"><link rel="prefetch" href="/mao-blog/assets/js/20.2d4db1fa.js"><link rel="prefetch" href="/mao-blog/assets/js/21.514837fa.js"><link rel="prefetch" href="/mao-blog/assets/js/22.27a37e8b.js"><link rel="prefetch" href="/mao-blog/assets/js/23.897a67bc.js"><link rel="prefetch" href="/mao-blog/assets/js/24.c649adb1.js"><link rel="prefetch" href="/mao-blog/assets/js/25.bccb3f04.js"><link rel="prefetch" href="/mao-blog/assets/js/26.705ac85b.js"><link rel="prefetch" href="/mao-blog/assets/js/27.e4123e2d.js"><link rel="prefetch" href="/mao-blog/assets/js/28.46bcae57.js"><link rel="prefetch" href="/mao-blog/assets/js/3.2246673a.js"><link rel="prefetch" href="/mao-blog/assets/js/30.28bc60fe.js"><link rel="prefetch" href="/mao-blog/assets/js/31.c3758186.js"><link rel="prefetch" href="/mao-blog/assets/js/32.db3244fa.js"><link rel="prefetch" href="/mao-blog/assets/js/33.06b2e404.js"><link rel="prefetch" href="/mao-blog/assets/js/34.87d9e7a4.js"><link rel="prefetch" href="/mao-blog/assets/js/35.c126287d.js"><link rel="prefetch" href="/mao-blog/assets/js/36.8f3be9db.js"><link rel="prefetch" href="/mao-blog/assets/js/37.b916e469.js"><link rel="prefetch" href="/mao-blog/assets/js/38.d90b2cf2.js"><link rel="prefetch" href="/mao-blog/assets/js/39.6e0ceebe.js"><link rel="prefetch" href="/mao-blog/assets/js/40.1b64d216.js"><link rel="prefetch" href="/mao-blog/assets/js/41.ebf384c2.js"><link rel="prefetch" href="/mao-blog/assets/js/42.9881274f.js"><link rel="prefetch" href="/mao-blog/assets/js/43.53f0eb78.js"><link rel="prefetch" href="/mao-blog/assets/js/44.56761054.js"><link rel="prefetch" href="/mao-blog/assets/js/45.b0ff1d14.js"><link rel="prefetch" href="/mao-blog/assets/js/46.aaaf7c00.js"><link rel="prefetch" href="/mao-blog/assets/js/47.18cca51b.js"><link rel="prefetch" href="/mao-blog/assets/js/48.39030ea6.js"><link rel="prefetch" href="/mao-blog/assets/js/49.9ab0ecf9.js"><link rel="prefetch" href="/mao-blog/assets/js/5.8cda11d4.js"><link rel="prefetch" href="/mao-blog/assets/js/50.0bffed31.js"><link rel="prefetch" href="/mao-blog/assets/js/51.ff3d6c79.js"><link rel="prefetch" href="/mao-blog/assets/js/52.87903e4e.js"><link rel="prefetch" href="/mao-blog/assets/js/53.5759e67a.js"><link rel="prefetch" href="/mao-blog/assets/js/54.be8026fc.js"><link rel="prefetch" href="/mao-blog/assets/js/55.866a8231.js"><link rel="prefetch" href="/mao-blog/assets/js/56.e12d34a8.js"><link rel="prefetch" href="/mao-blog/assets/js/57.57fd273b.js"><link rel="prefetch" href="/mao-blog/assets/js/58.90ce6d0a.js"><link rel="prefetch" href="/mao-blog/assets/js/59.3863dc39.js"><link rel="prefetch" href="/mao-blog/assets/js/6.6d443000.js"><link rel="prefetch" href="/mao-blog/assets/js/60.9e201b5f.js"><link rel="prefetch" href="/mao-blog/assets/js/61.d56ed0f8.js"><link rel="prefetch" href="/mao-blog/assets/js/62.b21d1cc3.js"><link rel="prefetch" href="/mao-blog/assets/js/63.eadaa890.js"><link rel="prefetch" href="/mao-blog/assets/js/64.67bc0773.js"><link rel="prefetch" href="/mao-blog/assets/js/65.ea6aa7cc.js"><link rel="prefetch" href="/mao-blog/assets/js/66.cc349a1f.js"><link rel="prefetch" href="/mao-blog/assets/js/67.838b75e8.js"><link rel="prefetch" href="/mao-blog/assets/js/68.e59ea1bc.js"><link rel="prefetch" href="/mao-blog/assets/js/69.6ac56165.js"><link rel="prefetch" href="/mao-blog/assets/js/7.4209526f.js"><link rel="prefetch" href="/mao-blog/assets/js/70.0dc5fc42.js"><link rel="prefetch" href="/mao-blog/assets/js/71.a9ff44b1.js"><link rel="prefetch" href="/mao-blog/assets/js/72.bd59cddf.js"><link rel="prefetch" href="/mao-blog/assets/js/73.b6b0d409.js"><link rel="prefetch" href="/mao-blog/assets/js/74.92094ea4.js"><link rel="prefetch" href="/mao-blog/assets/js/75.57b289ff.js"><link rel="prefetch" href="/mao-blog/assets/js/76.fae4f14d.js"><link rel="prefetch" href="/mao-blog/assets/js/77.c4f1a7a5.js"><link rel="prefetch" href="/mao-blog/assets/js/78.72a68f19.js"><link rel="prefetch" href="/mao-blog/assets/js/79.42919070.js"><link rel="prefetch" href="/mao-blog/assets/js/8.23939aab.js"><link rel="prefetch" href="/mao-blog/assets/js/80.063e6e91.js"><link rel="prefetch" href="/mao-blog/assets/js/81.c0a3b3d7.js"><link rel="prefetch" href="/mao-blog/assets/js/9.cea725c3.js">
    <link rel="stylesheet" href="/mao-blog/assets/css/0.styles.c7f09f7b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-1156296a><div data-v-1156296a><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-1156296a data-v-1156296a><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-4e82dffc data-v-1156296a data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>Mr.Mao's blog</h3> <p class="description" data-v-4e82dffc data-v-4e82dffc>For man is man and master of his fate.</p> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Mr.Mao</span>
            
          <span data-v-4e82dffc>2020 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-1156296a><header class="navbar" data-v-1156296a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mao-blog/" class="home-link router-link-active"><img src="/mao-blog/avatar.png" alt="Mr.Mao's blog" class="logo"> <span class="site-name">Mr.Mao's blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mao-blog/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      软件开发
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mao-blog/软件开发/前端笔记/01-HTML-超文本标记语言.html" class="nav-link"><i class="undefined"></i>
  前端开发
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/软件开发/后端笔记/01-php-后端应用.html" class="nav-link"><i class="undefined"></i>
  后端开发
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/软件开发/扩展笔记/01-Promise-异步解决方案.html" class="nav-link"><i class="undefined"></i>
  知识扩展
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-npm"></i>
      我的扩展
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mao-blog/我的扩展/create-uniapp-view.html" class="nav-link"><i class="undefined"></i>
  快速创建视图 | create-uniapp-view
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/我的扩展/u-draw-poster/01-base-desc.html" class="nav-link"><i class="undefined"></i>
  多端海报绘制 | uni-draw-poster
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/我的扩展/form-strategy.html" class="nav-link"><i class="undefined"></i>
  表单策略验证 | form-strategy
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-date"></i>
      规划指南
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mao-blog/规划指南/01-日常指标.html" class="nav-link"><i class="undefined"></i>
  生活指标
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/规划指南/02-总结与规划.html" class="nav-link"><i class="undefined"></i>
  总结与规划
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/个人记录/职场事项.html" class="nav-link"><i class="undefined"></i>
  职场 RULE
</a></li></ul></div></div><div class="nav-item"><a href="/mao-blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-1156296a></div> <aside class="sidebar" data-v-1156296a><div class="personal-info-wrapper" data-v-828910c6 data-v-1156296a><img src="/mao-blog/avatar.png" alt="author-avatar" class="personal-img" data-v-828910c6> <h3 class="name" data-v-828910c6>
    Mr.Mao
  </h3> <div class="num" data-v-828910c6><div data-v-828910c6><h3 data-v-828910c6>70</h3> <h6 data-v-828910c6>Articles</h6></div> <div data-v-828910c6><h3 data-v-828910c6>46</h3> <h6 data-v-828910c6>Tags</h6></div></div> <ul class="social-links" data-v-828910c6></ul> <hr data-v-828910c6></div> <nav class="nav-links"><div class="nav-item"><a href="/mao-blog/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      软件开发
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mao-blog/软件开发/前端笔记/01-HTML-超文本标记语言.html" class="nav-link"><i class="undefined"></i>
  前端开发
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/软件开发/后端笔记/01-php-后端应用.html" class="nav-link"><i class="undefined"></i>
  后端开发
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/软件开发/扩展笔记/01-Promise-异步解决方案.html" class="nav-link"><i class="undefined"></i>
  知识扩展
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-npm"></i>
      我的扩展
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mao-blog/我的扩展/create-uniapp-view.html" class="nav-link"><i class="undefined"></i>
  快速创建视图 | create-uniapp-view
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/我的扩展/u-draw-poster/01-base-desc.html" class="nav-link"><i class="undefined"></i>
  多端海报绘制 | uni-draw-poster
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/我的扩展/form-strategy.html" class="nav-link"><i class="undefined"></i>
  表单策略验证 | form-strategy
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-date"></i>
      规划指南
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mao-blog/规划指南/01-日常指标.html" class="nav-link"><i class="undefined"></i>
  生活指标
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/规划指南/02-总结与规划.html" class="nav-link"><i class="undefined"></i>
  总结与规划
</a></li><li class="dropdown-item"><!----> <a href="/mao-blog/个人记录/职场事项.html" class="nav-link"><i class="undefined"></i>
  职场 RULE
</a></li></ul></div></div><div class="nav-item"><a href="/mao-blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>后端笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/01-php-hou-duan-ying-yong.html" class="sidebar-link">php 后端应用</a></li><li><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/02-mysql-shu-ju-ku-ying-yong.html" class="sidebar-link">mysql 数据库应用</a></li><li><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/03-mongodb-fen-bu-shi-guan-xi-shu-ju-ku.html" class="sidebar-link">mongodb 分布式关系数据库</a></li><li><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/04-mongodb-cha-xun-yu-geng-xin-cao-zuo-fu.html" class="sidebar-link">mongodb 查询与更新操作符</a></li><li><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html" aria-current="page" class="active sidebar-link">nodejs 服务端CV8框架</a></li><li><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/06-express-webfu-wu-kai-fa.html" class="sidebar-link">Express Web服务开发</a></li><li><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/07-koa-webfu-wu-kai-fa.html" class="sidebar-link">Koa Web服务开发</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-4e82dffc data-v-1156296a><h3 class="title" data-v-4e82dffc data-v-4e82dffc>nodejs 服务端CV8框架</h3> <!----> <label id="box" class="inputBox" data-v-4e82dffc data-v-4e82dffc><input type="password" value="" data-v-4e82dffc> <span data-v-4e82dffc>Konck! Knock!</span> <button data-v-4e82dffc>OK</button></label> <div class="footer" data-v-4e82dffc data-v-4e82dffc><span data-v-4e82dffc><i class="iconfont reco-theme" data-v-4e82dffc></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-4e82dffc>vuePress-theme-reco</a></span> <span data-v-4e82dffc><i class="iconfont reco-copyright" data-v-4e82dffc></i> <a data-v-4e82dffc><span data-v-4e82dffc>Mr.Mao</span>
            
          <span data-v-4e82dffc>2020 - </span>
          2021
        </a></span></div></div> <div data-v-1156296a><main class="page"><section><div class="page-title"><h1 class="title">nodejs 服务端CV8框架</h1> <div data-v-1ff7123e><i class="iconfont reco-account" data-v-1ff7123e><span data-v-1ff7123e>Mr.Mao</span></i> <i class="iconfont reco-date" data-v-1ff7123e><span data-v-1ff7123e>11/1/2020</span></i> <i class="iconfont reco-eye" data-v-1ff7123e><span id="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-1ff7123e><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-1ff7123e><span class="tag-item" data-v-1ff7123e>nodejs</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="node-基础知识补充"><a href="#node-基础知识补充" class="header-anchor">#</a> Node 基础知识补充</h2> <h3 id="cmd基本知识"><a href="#cmd基本知识" class="header-anchor">#</a> CMD基本知识</h3> <p>命令行窗口（小黑屏）、CMD窗口、终端、shell
<code>开始菜单 --&gt; 运行 --&gt; CMD --&gt; 回车</code> <code>Win + R --&gt; CMD --&gt; 回车</code></p> <table><thead><tr><th>命令</th> <th>功能</th></tr></thead> <tbody><tr><td>dir</td> <td>列出当前目录下的所有文件</td></tr> <tr><td>cd 目录名</td> <td>进入到指定的目录</td></tr> <tr><td>md 目录名</td> <td>创建一个文件夹</td></tr> <tr><td>rd 目录名</td> <td>删除一个文件夹</td></tr></tbody></table> <h4 id="目录"><a href="#目录" class="header-anchor">#</a> 目录</h4> <p><code>.</code>表示当前目录
<code>..</code>表示上一级目录</p> <h3 id="环境变量-window系统中的变量"><a href="#环境变量-window系统中的变量" class="header-anchor">#</a> 环境变量（window系统中的变量 ）</h3> <p>​	PATH ：<code>C:\Program Files\Microsoft SQL Server\130\Tools\Binn\</code></p> <p>当我们在命令行窗口打开一个文件，或调用一个程序时，系统会首先在当前目录下寻找文件程序，如果找到了则直接打开
如果没有找到则会依次到环境变量path的路径中寻找，直到找到为止如果没找到则报错类似于作用域链
所以我们可以将一些经常需要访问的程序和文件的路径添加到path中，这样我们就可以在任意位置来访问这些文件和程序了</p> <h3 id="进程和线程"><a href="#进程和线程" class="header-anchor">#</a> 进程和线程</h3> <p><strong>进程：</strong> 进程负责为程序的运行提供必备的环境
进程就相当于工厂中的车间</p> <p><strong>线程：</strong> 线程是计算机中最小的计算单位，线程负责执行进程中的程序
线程就相当于工厂中的工人</p> <p>**单线程：**JS是单线程，在执行JS代码的时候网页是停止渲染的。</p> <p>**多线程：**主流的语言，如Java</p> <p><img src="/mao-blog/assets/img/12321i31mop23po.d38947c3.jpg" alt="多线程处理机制"></p> <h2 id="node-js-概念"><a href="#node-js-概念" class="header-anchor">#</a> Node.js 概念</h2> <p>Node.js是一个能够在服务器端运行JavaScript的开放源代码、跨平台JavaScript运行环境。</p> <p>Node采用Google开发的V8引擎运行js代码，使用事件驱动、非阻塞和异步I/O模型等技术来提高性能，可优化应用程序的传输量和规模。</p> <p>Node大部分基本模块都用JavaScript编写。在Node出现之前，JS通常作为客户端程序设计语言使用，以JS写出的程序常在用户的浏览器上运行。</p> <p>目前，Node已被IBM、Microsoft、Yahoo!、Walmart、Groupon、SAP、 LinkedIn、Rakuten、PayPal、VoxerGoDaddy等企业采用。</p> <p>Node主要用于编写像Web服务器一样的网络应用，这和PHP和Python是类似的。但是Node与其他语言最大的不同之处在于，PHP等语言是阻塞的而Node是非阻塞的。</p> <p>Node是事件驱动的。开发者可以在不使用线程的情况下开发出一个能够承载高并发的服务器。其他服务器端语言难以开发高并发应用，而且即使开发出来，性能也不尽人意，Node正是在这个前提下被创造出来。</p> <p>Node把JS的易学易用和Unix网络编程的强大结合到了一起。</p> <p>Node.js允许通过JS和一系列模块来编写服务器端应用和网络相关的应用。</p> <p>核心模块包括文件系统I/O、网络（HTTP、TCP、UDP、DNS、TLS/SSL等）、二进制数据流、加密算法、数据流等等。Node模块的API形式简单，降低了编程的复杂度。</p> <p>使用框架可以加速开发。常用的框架有Express.js、Socket.IO和Connect等。Node.js的程序可以在Microsoft Windows、Linux、Unix、Mac OS X等服务器上运行。</p> <p>Node.js也可以使用CoffeeScript、TypeScript、Dart语言，以及其他能够编译成JavaScript的语言编程。</p> <h3 id="node的用途"><a href="#node的用途" class="header-anchor">#</a> Node的用途</h3> <p>• Web服务API，比如REST
• 实时多人游戏
• 后端的Web服务，例如跨域、服务器端的请求
• 基于Web的应用
• 多客户端的通信，如即时通信</p> <h3 id="i-o-input-output"><a href="#i-o-input-output" class="header-anchor">#</a> I/O (Input/Output)</h3> <p>I/O操作指的是对磁盘的读写操作</p> <h3 id="node语言是js模型"><a href="#node语言是js模型" class="header-anchor">#</a> Node语言是JS模型</h3> <p>Node是对ES标准一个实现，Node也是一个JS引擎，通过Node可以使js代码在服务器端执行
Node仅仅对ES标准进行了实现，所以在Node中不包含DOM 和 BOM
Node编写都是单线程的服务器
Node处理请求时是单线程，但是在后台拥有一个I/O线程池</p> <h3 id="node中使用的内建对象"><a href="#node中使用的内建对象" class="header-anchor">#</a> Node中使用的内建对象</h3> <p><code>String Number Boolean Math Date RegExp Function Object Array</code> <code>BOM</code>，<code>DOM</code>不能使用，但是可以使用 <code>console</code> 也可以使用定时器<code>setTimeout() setInterval()</code></p> <h3 id="ecmascript标准的缺陷"><a href="#ecmascript标准的缺陷" class="header-anchor">#</a> ECMAScript标准的缺陷</h3> <p>没有模块系统，标准库较少，没有标准接口，缺乏管理系统</p> <h2 id="模块化-require"><a href="#模块化-require" class="header-anchor">#</a> 模块化（require）</h2> <p>如果程序设计的规模达到了一定程度，则必须对其进行模块化。
模块化可以有多种形式，但至少应该提供能够将代码分割为多个源文件的机制。
CommonJS 的模块功能可以帮我们解决该问题。
CommonJS规范的提出，主要是为了弥补当前JavaScript没有模块化标准的缺陷。
CommonJS规范为JS指定了一个美好的愿景，希望JS能够在任何地方运行。
CommonJS对模块的定义十分简单： – 模块引用 – 模块定义 – 模块标识</p> <h3 id="模块标识"><a href="#模块标识" class="header-anchor">#</a> 模块标识</h3> <p>模块标识其实就是模块的名字，也就是传递给require()方法的参数，它必须是符合驼峰命名法的字符串，或者是以.、…开头的相对路径、或者绝对路径。
模块的定义十分简单，接口也十分简洁。每个模块具有独立的空间，它们互不干扰，在引用时也显得干净利落。</p> <h3 id="核心模块"><a href="#核心模块" class="header-anchor">#</a> 核心模块</h3> <p>由node引擎提供的模块，核心模块的标识就是，模块的名字，里面封装着内置方法
<code>var fs = require(&quot;fs&quot;);</code></p> <h3 id="文件模块"><a href="#文件模块" class="header-anchor">#</a> 文件模块</h3> <p>由用户自己创建的模块，文件模块的标识就是文件的路径（绝对路径，相对路径）
相对路径使用.或..开头</p> <h3 id="模块定义"><a href="#模块定义" class="header-anchor">#</a> 模块定义</h3> <p>在运行环境中，提供了exports对象用于导出当前模块的方法或者变量，并且它是唯一的导出的出口。
在模块中还存在一个module对象，它代表模块自身，而exports是module的属性。
在Node中一个文件就是一个模块。</p> <h3 id="模块引用"><a href="#模块引用" class="header-anchor">#</a> 模块引用</h3> <p>在规范中，定义了require()方法，这个方法接手模块标识，以此将一个模块引入到当前运行环境中。
模块引用的示例代码：<code>require('模块').math</code></p> <h3 id="模块实例"><a href="#模块实例" class="header-anchor">#</a> 模块实例</h3> <p>Node中虽然使用的是CommonJS规范，但是其自身也对规范做了一些取舍。
在Node中引入模块，需要经历3个步骤	<code>– 路径分析	– 文件定位	– 编译执行</code>
在Node中，模块分为三类：一类是底层由C++编写的内建模块，一类是Node提供的核心模块；还有一类是用户编写的模块，称为文件模块。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 扩展模块</span>
<span class="token keyword">var</span> math <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./math&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 核心模块</span>
<span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">456</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fs<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们可以通过 exports 来向外部暴露变量和方法只需要将需要暴露给外部的变量或方法设置为exports的属性即可</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//向外部暴露属性或方法</span>
exports<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">&quot;我是02.module.js中的x&quot;</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token string">&quot;我是y&quot;</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="全局对象-global"><a href="#全局对象-global" class="header-anchor">#</a> 全局对象（global）</h2> <p>在全局中创建的变量和函数都会作为global的属性和方法保存</p> <p><strong>实际上模块中的代码都是包装在一个函数中执行的，并且在函数执行时，同时传递进了5个实参</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 当node在执行模块中的代码时，它会首先在代码的最顶部，添加如下代码</span>
<span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> __filename<span class="token punctuation">,</span> __dirname</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span> <span class="token comment">// 在代码的最底部，添加}代码</span>
</code></pre></div><ul><li>**exports：**该对象用来将变量或函数暴露到外部</li> <li>**require：**函数，用来引入外部的模块</li> <li>**module：**代表的是当前模块本身</li> <li>**__filename：**当前模块的完整路径
<code>C:\Users\lilichao\WebstormProjects\class0705\01.node\04.module.js</code></li> <li>**__dirname：**当前模块所在文件夹的完整路径
<code>当前模块所在文件夹的完整路径</code></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>global<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>callee <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//- 这个属性保存的是当前执行的函数对象</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>exports<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>exports <span class="token operator">==</span> exports<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="exports-和-module-exports"><a href="#exports-和-module-exports" class="header-anchor">#</a> exports 和 module.exports</h3> <p>通过exports只能使用.的方式来向外暴露内部变量
<code>exports.xxx = xxx</code>
而module.exports既可以通过.的形式，也可以直接赋值
<code>module.exports.xxx = xxxx</code> <code>module.exports = {}</code>
这样有个好处，就是引入的时候可以直接使用返回的exports值，不用通过.xxx获取</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 模块一定义</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 模块二引入</span>
<span class="token keyword">var</span> demo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;模块一&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//demo = {}</span>
</code></pre></div><h2 id="模块包-package"><a href="#模块包-package" class="header-anchor">#</a> 模块包（package）</h2> <p>CommonJS的包规范允许我们将一组相关的模块组合到一起，形成一组完整的工具。
CommonJS的包规范由包结构和包描述文件两个部分组成。</p> <h3 id="引入包和使用包"><a href="#引入包和使用包" class="header-anchor">#</a> 引入包和使用包</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> math <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'math'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">456</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>包结构：</strong> 组织包中的各种文件，实际上就是一个压缩文件，解压以后还原为目录。符合规范的目录，应该包含如下文件：
<code>– package.json 描述文件	– bin 可执行二进制文件	– lib js代码	– doc 文档	– test 单元测试</code></p> <p><strong>包描述文件：</strong> 描述包的相关信息，用于表达非代码相关的信息，它是一个JSON格式的文件 – package.json，位于包的根目录下，是包的重要组成部分。
package.json中的字段：<code>name、description、version、keywords、maintainers、contributors、bugs、licenses、repositories、dependencies、homepage、os、cpu、engine、builtin、directories、implements、scripts、author、bin、main、devDependencies。</code></p> <h2 id="缓冲区-buffer"><a href="#缓冲区-buffer" class="header-anchor">#</a> 缓冲区（Buffer）</h2> <p>从结构上看Buffer非常像一个数组，它的元素为16进制的两位数。一个元素就表示内存中的一个字节。
JS数组性能比其他语言的数组差，但Buffer中的内存不是通过JavaScript分配的，而是在底层通过C++申请的。也就是我们可以直接通过Buffer来创建内存中的空间。</p> <ul><li><p>Buffer的结构和数组很像，操作的方法也和数组类似</p></li> <li><p>数组中不能存储二进制的文件，而buffer就是专门用来存储二进制数据</p></li> <li><p>使用buffer不需要引入模块，直接使用即可</p></li> <li><p>在buffer中存储的都是二进制数据，但是在显示时都是以16进制的形式显示，buffer中每一个元素的范围是从
00 - ff   0 - 255，00000000 - 11111111</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 计算机 一个0 或一个1 我们称为1位（bit）</span>
	<span class="token number">8</span>bit <span class="token operator">=</span> <span class="token number">1</span>byte（字节）
	<span class="token number">1024</span>byte <span class="token operator">=</span> <span class="token number">1</span>kb
	<span class="token number">1024</span>kb <span class="token operator">=</span> <span class="token number">1</span>mb
	<span class="token number">1024</span>mb <span class="token operator">=</span> <span class="token number">1</span>gb
	<span class="token number">1024</span>gb <span class="token operator">=</span> <span class="token number">1</span>tb
</code></pre></div></li> <li><p>buffer中的一个元素，占用内存的一个字节</p></li> <li><p>Buffer的大小一旦确定，则不能修改，Buffer实际上是对底层内存的直接操作</p></li></ul> <h3 id="bufferapi-方法"><a href="#bufferapi-方法" class="header-anchor">#</a> BufferApi 方法</h3> <p><code>Buffer.from(str)</code>将一个字符串转换为buffer
<code>Buffer.alloc(size)</code> 创建一个指定大小的Buffer
<code>Buffer.alloUnsafe(size)</code>创建一个指定大小的Buffer，但是可能包含敏感数据
<code>buf.toString()</code>将缓冲区中的数据转换为字符串</p> <h3 id="bufferapi实例"><a href="#bufferapi实例" class="header-anchor">#</a> BufferApi实例</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;Hello 尚硅谷&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//将一个字符串保存到buffer中</span>
<span class="token keyword">var</span> buf <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//创建一个10个字节的buffer</span>
<span class="token keyword">var</span> buf2 <span class="token operator">=</span> Buffer<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//通过索引，来操作buf中的元素</span>
buf2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">88</span><span class="token punctuation">;</span>
buf2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>
buf2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0xaa</span><span class="token punctuation">;</span>
buf2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token comment">//超过二进制8位就会舍掉前面多的</span>
buf2<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token comment">//一旦确定长度,不可修改</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf2<span class="token punctuation">)</span> <span class="token comment">// &lt;Buffer 58 ff aa 00 00 00 00 00 00 00&gt;</span>
<span class="token comment">//只要数字在控制台或页面中输出一定是10进制</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 170</span>
<span class="token comment">//转换为16进制的字符串 </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>buf2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token comment">// aa</span>
</code></pre></div><h2 id="文件系统-fs"><a href="#文件系统-fs" class="header-anchor">#</a> 文件系统（fs）</h2> <p>在Node中，与文件系统的交互是非常重要的，服务器的本质就将本地的文件发送给远程的客户端。Node通过fs模块来和文件系统进行交互。该模块提供了一些标准文件访问API来打开、读取、写入文件，以及与其交互。要使用fs模块，首先需要对其进行加载。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>同步和异步调用</strong></p> <p>fs模块中所有的操作都有两种形式可供选择同步和异步。
同步文件系统会阻塞程序的执行，也就是除非操作完毕，否则不会向下执行代码。
异步文件系统不会阻塞程序的执行，而是在操作完成时，通过回调函数将结果返回。</p> <h3 id="打开-关闭文件"><a href="#打开-关闭文件" class="header-anchor">#</a> 打开&amp;关闭文件</h3> <h4 id="异步打开文件"><a href="#异步打开文件" class="header-anchor">#</a> 异步打开文件</h4> <p><code>fs.open(path, flags[, mode], callback(fd))</code> <code>fs.openSync(path, flags[, mode])</code></p> <h4 id="同步关闭文件"><a href="#同步关闭文件" class="header-anchor">#</a> 同步关闭文件</h4> <p><code>fs.close(fd, callback)</code> <code>fs.closeSync(fd)</code></p> <ul><li><strong>path</strong> - 文件的路径。</li> <li><strong>flags</strong> - 文件打开的行为。具体值详见下文。</li> <li><strong>mode</strong> - 设置文件模式(权限)，文件创建默认权限为 0666(可读，可写)。</li> <li><strong>callback</strong> - 回调函数，带有两个参数如：callback(err, fd)。</li></ul> <h4 id="flags-参数列表"><a href="#flags-参数列表" class="header-anchor">#</a> flags 参数列表</h4> <table><thead><tr><th>Flag</th> <th>描述</th></tr></thead> <tbody><tr><td>r</td> <td>以读取模式打开文件。如果文件不存在抛出异常。</td></tr> <tr><td>r+</td> <td>以读写模式打开文件。如果文件不存在抛出异常。</td></tr> <tr><td>rs</td> <td>以同步的方式读取文件。</td></tr> <tr><td>rs+</td> <td>以同步的方式读取和写入文件。</td></tr> <tr><td>w</td> <td>以写入模式打开文件，如果文件不存在则创建。</td></tr> <tr><td>wx</td> <td>类似 'w'，但是如果文件路径存在，则文件写入失败</td></tr> <tr><td>w+</td> <td>以读写模式打开文件，如果文件不存在则创建。</td></tr> <tr><td>wx+</td> <td>类似 'w+'， 但是如果文件路径存在，则文件读写失败。</td></tr> <tr><td>a</td> <td>以追加模式打开文件，如果文件不存在则创建。</td></tr> <tr><td>ax</td> <td>类似 'a'， 但是如果文件路径存在，则文件追加失败。</td></tr> <tr><td>a+</td> <td>以读取追加模式打开文件，如果文件不存在则创建。</td></tr> <tr><td>ax+</td> <td>类似 'a+'， 但是如果文件路径存在，则文件读取追加失败。</td></tr></tbody></table> <h4 id="open实例"><a href="#open实例" class="header-anchor">#</a> open实例</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 异步打开文件</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;准备打开文件！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'input.txt'</span><span class="token punctuation">,</span> <span class="token string">'r+'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fd</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;文件打开成功！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>$ node file.js 
准备打开文件！
文件打开成功！
</code></pre></div><h3 id="写入文件"><a href="#写入文件" class="header-anchor">#</a> 写入文件</h3> <p>fs中提供了四种不同的方式将数据写入文件
<code>– 简单文件写入	– 同步文件写入	– 异步文件写入	– 流式文件写入</code></p> <h4 id="简单文件写入"><a href="#简单文件写入" class="header-anchor">#</a> 简单文件写入</h4> <p>fs.writeFile(file, data[, options], callback)
fs.writeFileSync(file, data[, options])</p> <ul><li>**file ** - 文件的路径。</li> <li>**data ** - 被写入的内容，可以是String或Buffer。</li> <li>**options ** - 对象，包含属性（encoding、mode、flag）</li> <li><strong>callback</strong> - 回调函数，带有两个参数如：callback(err, fd)。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'hello.txt'</span><span class="token punctuation">,</span><span class="token string">'这是通过writeFile写入的内容'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>flag<span class="token operator">:</span><span class="token string">'w'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'写入成功~~~'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'失败'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="同步文件写入"><a href="#同步文件写入" class="header-anchor">#</a> 同步文件写入</h4> <p><code>fs.writeSync(fd, buffer, offset, length[, position])</code> <code>fs.writeSync(fd, data[, position[, encoding]])</code>
要完成同步写入文件，先需要通过openSync()打开文件来获取一个文件描述符，然后在通过writeSync()写入文件。</p> <ul><li>**fd ** - 文件描述符，通过openSync()获取</li> <li>**data ** - 被写入的内容，可以是String或Buffer。</li> <li><strong>offset</strong> -  buffer写入的偏移量</li> <li>**length ** - 写入的长度</li> <li>**position ** - 写入的起始位置</li> <li><strong>encoding</strong>  -  写入编码</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> fsTxt <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">openSync</span><span class="token punctuation">(</span><span class="token string">'hello.txt'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//打开文件</span>
<span class="token comment">//文件编号为3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fsTxt<span class="token punctuation">)</span>
<span class="token comment">//向文件中写入内容</span>
fs<span class="token punctuation">.</span><span class="token function">writeSync</span><span class="token punctuation">(</span>fsTxt<span class="token punctuation">,</span><span class="token string">'今天天气真不错~~~~'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//关闭文件</span>
fs<span class="token punctuation">.</span><span class="token function">closeSync</span><span class="token punctuation">(</span>fsTxt<span class="token punctuation">)</span>
</code></pre></div><h4 id="异步文件写入"><a href="#异步文件写入" class="header-anchor">#</a> 异步文件写入</h4> <p><code>fs.write(fd, buffer, offset, length[, position], callback)</code> <code>fs.write(fd, data[, position[, encoding]], callback)</code>
要使用异步写入文件，先需要通过open()打开文件，然后在回调函数中通过write()写入。</p> <ul><li>**fd ** - 文件描述符，通过openSync()获取</li> <li>**data ** - 被写入的内容，可以是String或Buffer。</li> <li><strong>offset</strong> -  buffer写入的偏移量</li> <li>**length ** - 写入的长度</li> <li>**position ** - 写入的起始位置</li> <li><strong>encoding</strong>  -  写入编码</li> <li><strong>callback</strong>  -  回调函数</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//打开文件</span>
<span class="token keyword">var</span> fd <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'hello.txt'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>fd</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//判断是否出错</span>
		<span class="token comment">//如果没有出错，则对文件进入写入</span>
		fs<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span><span class="token string">'这是异步写入的内容'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//文件写入</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'写入成功'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
			fs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'文件已关闭'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//关闭文件</span>
			
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">//如果出错则弹出错误</span>
</code></pre></div><h4 id="流式文件写入"><a href="#流式文件写入" class="header-anchor">#</a> 流式文件写入</h4> <p>往一个文件中写入大量数据时，最好的方法之一是使用流。
若要将数据异步传送到文件，首需要使用以下语法创建一个Writable对象：
<code>fs.createWriteStream(path[, options])</code></p> <ul><li>**path **  -  文件路径</li> <li><strong>options</strong>  -  对象，包含属性（encoding、mode、flag）</li></ul> <p><strong>一旦你打开了Writable文件流，就可以使用write()方法来写入它，写入完成后，在调用end()方法来      关闭流。</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'hello.txt'</span><span class="token punctuation">)</span> <span class="token comment">// 开启hello.txt的文件流</span>
</code></pre></div><p><strong>可以通过监听流的open和close事件来监听流的打开和关闭</strong> <code>on(事件字符串,回调函数)	为对象绑定一个事件</code> <code>once(事件字符串,回调函数)	为对象绑定一次性的事件</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'流打开了~~~~'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
ws<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'流关闭了~~~~'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>调用文件流write方法写入</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'通过可写流写入文件的内容'</span><span class="token punctuation">)</span>
ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'今天天气真不错'</span><span class="token punctuation">)</span>
ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'锄禾日当午'</span><span class="token punctuation">)</span>
ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'红掌拨清清'</span><span class="token punctuation">)</span>
ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'清清真漂亮'</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>调用文件流end方法关闭流</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="读取文件"><a href="#读取文件" class="header-anchor">#</a> 读取文件</h3> <p>fs中提供了四种读取文件的方式
<code>– 简单文件读取 – 同步文件读取 – 异步文件读取 – 流式文件读取</code></p> <h4 id="简单文件读取"><a href="#简单文件读取" class="header-anchor">#</a> 简单文件读取</h4> <p><code>fs.readFile(file[, options], callback)</code> <code>fs.readFileSync(file[, options])</code></p> <ul><li>**file ** - 文件的路径。</li> <li>**options ** - 对象，包含属性（encoding、mode、flag）</li> <li><strong>callback</strong> - 回调函数，带有两个参数如：callback(err, fd)。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'派大星.jpg'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 读取文件</span>
	fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'成了.jpg'</span><span class="token punctuation">,</span>data<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">!</span>err <span class="token operator">?</span><span class="token string">'成功'</span><span class="token operator">:</span><span class="token string">'失败'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">// 写入文件</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取出错'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="同步文件读取"><a href="#同步文件读取" class="header-anchor">#</a> 同步文件读取</h4> <p>• fs.readSync(fd, buffer, offset, length, position)</p> <ul><li>**fd ** - 文件描述符，通过openSync()获取</li> <li><strong>buffer</strong> -  读取文件的缓冲区</li> <li>**offset ** - buffer的开始写入的位置</li> <li><strong>length</strong> - 要读取的字节数</li> <li>**position ** - 写入的起始位置</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'123.txt'</span> <span class="token punctuation">,</span> <span class="token string">'r'</span> <span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>fd</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 读取文件</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span> 
 <span class="token keyword">var</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> readfile <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readSync</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回读取的字节数</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="异步文件读取"><a href="#异步文件读取" class="header-anchor">#</a> 异步文件读取</h4> <p><code>fs.read(fd, buffer, offset, length, position, callback)</code></p> <ul><li>**fd ** - 文件描述符，通过openSync()获取</li> <li><strong>buffer</strong> - 读取文件的缓冲区</li> <li><strong>offset</strong> -  buffer写入的偏移量</li> <li>**length ** - 要读取的字节数</li> <li>**position ** - 开始读取文件的位置</li> <li><strong>callback</strong>  -  回调函数 参数err , bytesRead , buffer</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>fs<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'123.txt'</span> <span class="token punctuation">,</span> <span class="token string">'r'</span> <span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>fd</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 读取文件</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span> 
 <span class="token keyword">var</span> buf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Buffer</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> readfile <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">readfile</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>readfile<span class="token punctuation">)</span> <span class="token comment">// 返回读取的字节数</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="流式文件读取"><a href="#流式文件读取" class="header-anchor">#</a> 流式文件读取</h4> <p>从一个文件中读取大量的数据时，最好的方法之一就是流式读取，这样将把一个文件作为Readable流  的形式打开。
要从异步从文件传输数据，首先需要通过以下语法创建一个Readable流对象：<code>fs.createReadStream(path[, options])</code></p> <ul><li>**path ** - 文件路径</li> <li><strong>options</strong> - {encoding:&quot;&quot;,mode:&quot;&quot;,flag:&quot;&quot;}</li></ul> <p><strong>当你打开Readable文件流以后，可以通过readable事件和read()请求，或通过data事件处理程序   轻松地从它读出。</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'test.mp4'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'HuoGuoP.mp4'</span><span class="token punctuation">)</span>
<span class="token comment">//监听流的开启和关闭</span>
rs<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'open'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取流打开了~~~~'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//数据读取完毕，关闭可写流</span>
rs<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'close'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'读取流关闭了~~~~'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ws<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//如果要读取一个可读流中的数据，必须要为可读流绑定一个data事件</span>
rs<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">//data事件绑定完毕，它会自动开始读取数据</span>
	ws<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token comment">// 写入文件</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>pipe()方法将可读流内容直接输出到可写流中，并且自动关闭</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> rs <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'test.mp4'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> ws <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'HuoGuoP.mp4'</span><span class="token punctuation">)</span>
rs<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ws<span class="token punctuation">)</span>
</code></pre></div><h3 id="其他操作"><a href="#其他操作" class="header-anchor">#</a> 其他操作</h3> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">##</span> 验证路径是否存在</span>
	<span class="token list punctuation">-</span> fs.exists(path, callback)
	<span class="token list punctuation">-</span> fs.existsSync(path)
<span class="token title important"><span class="token punctuation">##</span> 获取文件信息</span>
	<span class="token list punctuation">-</span> fs.stat(path, callback)
	<span class="token list punctuation">-</span> fs.statSync(path)
<span class="token title important"><span class="token punctuation">##</span> 删除文件</span>
	<span class="token list punctuation">-</span> fs.unlink(path, callback)
	<span class="token list punctuation">-</span> fs.unlinkSync(path)
<span class="token title important"><span class="token punctuation">##</span> 列出文件</span>
	<span class="token list punctuation">-</span> fs.readdir(path[, options], callback)
	<span class="token list punctuation">-</span> fs.readdirSync(path[, options])
<span class="token title important"><span class="token punctuation">##</span> 截断文件</span>
	<span class="token list punctuation">-</span> fs.truncate(path, len, callback)
	<span class="token list punctuation">-</span> fs.truncateSync(path, len)
<span class="token title important"><span class="token punctuation">##</span> 建立目录</span>
	<span class="token list punctuation">-</span> fs.mkdir(path[, mode], callback)
	<span class="token list punctuation">-</span> fs.mkdirSync(path[, mode])
<span class="token title important"><span class="token punctuation">##</span> 删除目录</span>
	<span class="token list punctuation">-</span> fs.rmdir(path, callback)
	<span class="token list punctuation">-</span> fs.rmdirSync(path)
<span class="token title important"><span class="token punctuation">##</span> 重命名文件/文件夹</span>
	<span class="token list punctuation">-</span> fs.rename(oldPath, newPath, callback)
	<span class="token list punctuation">-</span> fs.renameSync(oldPath, newPath)
<span class="token title important"><span class="token punctuation">##</span> 监视文件/文件夹更改写入</span>
	<span class="token list punctuation">-</span> fs.watch(path, [, options], callback) =&gt; 性能较好
	<span class="token list punctuation">-</span> fs.watchFile(path, [, options], callback)
<span class="token title important"><span class="token punctuation">##</span> 返回文件数据/判断是否是文件或文件夹</span>
	<span class="token list punctuation">-</span> fs.lstatSync(path[, options])
		.isFile() // 是否是文件
		.isDirectory() // 是否是文件夹
	<span class="token list punctuation">-</span> fs.stat(path, [, options], callback)
</code></pre></div><h2 id="路径系统-path"><a href="#路径系统-path" class="header-anchor">#</a> 路径系统 (path)</h2> <p><code>path</code> 模块提供了一些用于处理文件与目录的路径的实用工具。</p> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">##</span> 提取文件扩展名</span>
	<span class="token list punctuation">-</span> path.extname(path)
<span class="token title important"><span class="token punctuation">##</span> 拼接路径字符串</span>
	<span class="token list punctuation">-</span> path.join([...paths])
	<span class="token list punctuation">-</span> path.resolve([...paths])
<span class="token title important"><span class="token punctuation">##</span> 解析路径完整信息</span>
	<span class="token list punctuation">-</span> path.parse(path)
</code></pre></div><p>####### ###</p> <h2 id="操作系统-os"><a href="#操作系统-os" class="header-anchor">#</a> 操作系统 (os)</h2> <p><code>os</code> 模块提供了与操作系统相关的实用方法和属性。</p> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">##</span> 查看CPU架构</span>
	<span class="token list punctuation">-</span> os.arch()
<span class="token title important"><span class="token punctuation">##</span> CPU内核信息/状态</span>
	<span class="token list punctuation">-</span> os.cpus()
<span class="token title important"><span class="token punctuation">##</span> 系统内存总量</span>
	<span class="token list punctuation">-</span> os.totalmem()
<span class="token title important"><span class="token punctuation">##</span> 系统空闲内存量</span>
	<span class="token list punctuation">-</span> os.freemem()
<span class="token title important"><span class="token punctuation">##</span> 操作系统名称</span>
	<span class="token list punctuation">-</span> os.type()
<span class="token title important"><span class="token punctuation">##</span> 系统正常运行时间</span>
	<span class="token list punctuation">-</span> os.uptime()
<span class="token title important"><span class="token punctuation">##</span> 操作系统主机名</span>
	<span class="token list punctuation">-</span> os.hostname()
</code></pre></div><p>####### ###</p> <h2 id="地址解析系统-url"><a href="#地址解析系统-url" class="header-anchor">#</a> 地址解析系统 (url)</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> URL_Info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'https://translate.google.cn/?search=6#view=home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>URL_Info<span class="token punctuation">)</span>
<span class="token comment">// ===&gt;</span>
<span class="token constant">URL</span> <span class="token punctuation">{</span>
  href<span class="token operator">:</span> <span class="token string">'https://translate.google.cn/?#view=home/search=6'</span><span class="token punctuation">,</span> 	<span class="token comment">// 地址</span>
  origin<span class="token operator">:</span> <span class="token string">'https://translate.google.cn'</span><span class="token punctuation">,</span> 	<span class="token comment">// 根路径地址</span>
  protocol<span class="token operator">:</span> <span class="token string">'https:'</span><span class="token punctuation">,</span>		<span class="token comment">// 请求协议</span>
  username<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>		<span class="token comment">// 邮箱用户名部分</span>
  password<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>		<span class="token comment">// 邮箱密码部分</span>
  host<span class="token operator">:</span> <span class="token string">'translate.google.cn'</span><span class="token punctuation">,</span>	<span class="token comment">// URL主机部分(包含端口)</span>
  hostname<span class="token operator">:</span> <span class="token string">'translate.google.cn'</span><span class="token punctuation">,</span>		<span class="token comment">// URL主机部分(不包含端口)</span>
  port<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>		<span class="token comment">// URL端口部分</span>
  pathname<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>	<span class="token comment">// URL路径部分</span>
  search<span class="token operator">:</span> <span class="token string">'?search=6'</span><span class="token punctuation">,</span>	<span class="token comment">// URL查询字符串部分</span>
  searchParams<span class="token operator">:</span> URLSearchParams <span class="token punctuation">{</span> <span class="token string">'search'</span> <span class="token operator">=&gt;</span> <span class="token string">'6'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>	<span class="token comment">// // URL查询字符串组成的对象</span>
  hash<span class="token operator">:</span> <span class="token string">'#view=home'</span>	<span class="token comment">// 田子码符串部分</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span>
url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'/search?title=helloWord'</span><span class="token punctuation">)</span>
<span class="token comment">// ===&gt;</span>
<span class="token operator">/</span>search<span class="token operator">?</span>title<span class="token operator">=</span>helloWord Url <span class="token punctuation">{</span>
  protocol<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  slashes<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  auth<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  host<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  port<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  hostname<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  hash<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  search<span class="token operator">:</span> <span class="token string">'?title=helloWord'</span><span class="token punctuation">,</span>
  query<span class="token operator">:</span> <span class="token string">'title=helloWord'</span><span class="token punctuation">,</span>
  pathname<span class="token operator">:</span> <span class="token string">'/search'</span><span class="token punctuation">,</span>
  path<span class="token operator">:</span> <span class="token string">'/search?title=helloWord'</span><span class="token punctuation">,</span>
  href<span class="token operator">:</span> <span class="token string">'/search?title=helloWord'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>####### ###</p> <h2 id="服务器系统-http-https"><a href="#服务器系统-http-https" class="header-anchor">#</a> 服务器系统 (http|https)</h2> <p>nodejs提供了http|https模块，自身就可以用来构建服务器，而且http模块是由C++实现的，性能可靠。</p> <h3 id="开启本地服务器的基本流程"><a href="#开启本地服务器的基本流程" class="header-anchor">#</a> 开启本地服务器的基本流程</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入本地服务器API</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token comment">// 创建服务器实例</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 绑定接收请求事件</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token comment">// 请求路径 (请求路径永远以 &quot;/&quot; 开头)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
  <span class="token comment">// 根据请求路径处理事件, 返回对应数据给用户</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 绑定监听端口号, 开启服务器</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'服务器开启成功, 端口号为:3000'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="req-请求-携带的常用参数"><a href="#req-请求-携带的常用参数" class="header-anchor">#</a> req (请求) 携带的常用参数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求路径 (请求路径永远以 &quot;/&quot; 开头)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
    <span class="token comment">// 请求头对象</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>headers<span class="token punctuation">)</span>
    <span class="token comment">// 请求类型</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>method<span class="token punctuation">)</span>

    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'服务器开启成功, 端口号为:3000'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="req-响应-携带的常用参数"><a href="#req-响应-携带的常用参数" class="header-anchor">#</a> req (响应) 携带的常用参数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置状态码和响应头</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token operator">:</span><span class="token string">'text/plain'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 设置响应头</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> <span class="token string">'text/plain'</span><span class="token punctuation">)</span>
    <span class="token comment">// 写入内容</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fileData<span class="token punctuation">)</span>
    <span class="token comment">// 结束响应</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hello word'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'服务器开启成功, 端口号为:3000'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="加密系统-crypto"><a href="#加密系统-crypto" class="header-anchor">#</a> 加密系统 (crypto)</h2> <p><code>crypto</code> 模块提供了加密功能，实现了包括对 OpenSSL 的哈希、HMAC、加密、解密、签名、以及验证功能的一整套封装。<code>Hash</code> 类是用于创建数据加密哈希值的工具类。查看 crypto 模块支持的 hash 函数：<code>crypto.getHashes()</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'RSA-MD4'</span><span class="token punctuation">,</span> <span class="token string">'RSA-MD5'</span><span class="token punctuation">,</span> <span class="token string">'RSA-MDC2'</span><span class="token punctuation">,</span> <span class="token string">'RSA-RIPEMD160'</span><span class="token punctuation">,</span>
<span class="token string">'RSA-SHA1'</span><span class="token punctuation">,</span> <span class="token string">'RSA-SHA1-2'</span><span class="token punctuation">,</span> <span class="token string">'RSA-SHA224'</span><span class="token punctuation">,</span> <span class="token string">'RSA-SHA256'</span><span class="token punctuation">,</span>
<span class="token string">'RSA-SHA384'</span><span class="token punctuation">,</span> <span class="token string">'RSA-SHA512'</span><span class="token punctuation">,</span> <span class="token string">'blake2b512'</span><span class="token punctuation">,</span> <span class="token string">'blake2s256'</span><span class="token punctuation">,</span>
<span class="token string">'md4'</span><span class="token punctuation">,</span> <span class="token string">'md4WithRSAEncryption'</span><span class="token punctuation">,</span> <span class="token string">'md5'</span><span class="token punctuation">,</span> <span class="token string">'md5-sha1'</span><span class="token punctuation">,</span>
<span class="token string">'md5WithRSAEncryption'</span><span class="token punctuation">,</span> <span class="token string">'mdc2'</span><span class="token punctuation">,</span> <span class="token string">'mdc2WithRSA'</span><span class="token punctuation">,</span> <span class="token string">'ripemd'</span><span class="token punctuation">,</span>
<span class="token string">'ripemd160'</span><span class="token punctuation">,</span><span class="token string">'ripemd160WithRSA'</span><span class="token punctuation">,</span><span class="token string">'rmd160'</span><span class="token punctuation">,</span><span class="token string">'sha1'</span><span class="token punctuation">,</span>
<span class="token string">'sha1WithRSAEncryption'</span><span class="token punctuation">,</span><span class="token string">'sha224'</span><span class="token punctuation">,</span><span class="token string">'sha224WithRSAEncryption'</span><span class="token punctuation">,</span>
<span class="token string">'sha256'</span><span class="token punctuation">,</span><span class="token string">'sha256WithRSAEncryption'</span><span class="token punctuation">,</span><span class="token string">'sha384'</span><span class="token punctuation">,</span><span class="token string">'sha384WithRSAEncryption'</span><span class="token punctuation">,</span>
<span class="token string">'sha512'</span><span class="token punctuation">,</span><span class="token string">'sha512WithRSAEncryption'</span><span class="token punctuation">,</span><span class="token string">'ssl3-md5'</span><span class="token punctuation">,</span><span class="token string">'ssl3-sha1'</span><span class="token punctuation">,</span><span class="token string">'whirlpool'</span>
</code></pre></div><h3 id="hash-加密-sha-256"><a href="#hash-加密-sha-256" class="header-anchor">#</a> hash 加密(SHA-256)</h3> <p>hash算法加密使用 <code>hash.update()</code> 方法将要计算的数据以流（stream）的方式写入，流输入结束后，使用 <code>hash.digest()</code> 方法计算数据的 hash 值解析为字符串。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建哈希函数 sha256</span>
<span class="token keyword">const</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'sha256'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// 输入流编码：utf8、ascii、binary（默认）</span>
hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">'some data to hash'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出编码：hex、binary、base64</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 输出</span>
<span class="token comment">// 6a2da20943931e9834fc12cfe5bb47bbd9ae43489a30726962b576f4e3993e50</span>
</code></pre></div><h3 id="pbkdf2-加密-sha256"><a href="#pbkdf2-加密-sha256" class="header-anchor">#</a> PBKDF2 加密(sha256)</h3> <p>PBKDF2算法加密通过多次hash来对密码进行加密。原理是通过str(加密字符串)和salt(盐值)进行hash(哈希值加密)，然后将结果作为salt在与str进行hash，多次重复此过程，生成最终的密文。</p> <p>PBKDF2 是 Node.js 的 <strong>crypto</strong> 模块原生支持的标准方法。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 同步函数示例 --&gt;</span>
<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span>
<span class="token comment">// crypto.randomBytes() 方法生成 32 字节的随机数 - 这里作为盐值</span>
<span class="token keyword">const</span> salt <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 参数列表：(未加密字符串, 盐值, 迭代次数, 密钥长度, 摘要函数-hash加密)</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">pbkdf2Sync</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> salt<span class="token punctuation">,</span> <span class="token number">4096</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">,</span> <span class="token string">'sha256'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="salt-盐值加密-md5"><a href="#salt-盐值加密-md5" class="header-anchor">#</a> salt 盐值加密(md5)</h3> <p>盐值就是随机数值，用于在计算密码的哈希值时插入特定的字符串，加强数据的安全性，可以有效抵御诸如字典攻击、彩虹表攻击等密码攻击媒介。</p> <p><strong>常见的 Hash 算法使用示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> md5 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token comment">// 直接对密码原文进行 Hash</span>
md5<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>md5<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 输出</span>
<span class="token comment">// e10adc3949ba59abbe56e057f20f883e</span>
<span class="token comment">// 可以通过 &lt;https://www.cmd5.com/&gt; 反向查询得到密码，不够安全。</span>
</code></pre></div><p><strong>加“盐”的 Hash 算法</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> md5 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 生成强加密的伪随机数</span>
<span class="token keyword">const</span> buf <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> salt <span class="token operator">=</span> buf<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>

<span class="token comment">// 将密码拼接上任意长度的随机字符串后，再进行 Hash</span>
<span class="token keyword">let</span> password <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
md5<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>password<span class="token operator">+</span>salt<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>md5<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出</span>
<span class="token comment">// a43bfb9f12b6f69ad9fcd4338a981efbed2569a</span>
</code></pre></div><h3 id="hmac-加密-sha1"><a href="#hmac-加密-sha1" class="header-anchor">#</a> Hmac 加密(sha1)</h3> <p>HMAC算法加密是将散列算法与一个密钥结合在一起，以阻止对签名完整性破坏，其实就是类似于上面的提到的md5密码中加盐道理是类似的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建hmac_hash函数(算法, 密匙)</span>
<span class="token keyword">const</span> hmac <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHmac</span><span class="token punctuation">(</span><span class="token string">'sha1'</span><span class="token punctuation">,</span> <span class="token string">'BDvDYUmfdykkBLgX'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 对字符串进行hash加密</span>
hmac<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">'data to crypt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 解析hash为字符串格式</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>hmac<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// 输出</span>
<span class="token comment">// a43bfb9f12b6f69ad9fcd4338a981efbed2569ae</span>
</code></pre></div><h3 id="cipher-加密-和-decipher-解密"><a href="#cipher-加密-和-decipher-解密" class="header-anchor">#</a> Cipher (加密) 和 Decipher (解密)</h3> <p>Cipher类用于加密数据，属于对称密钥加密，假设通信双方A、B，通讯方A使用key对明文进行加密传输，通讯方B接收到密文后，使用同样的key进行解密得到明文。Cipher加密算法字符串格式是 <code>算法-秘钥长度-模式</code> node.js支持的有以下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">'aes-128-cbc'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-cbc-hmac-sha1'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-cbc-hmac-sha256'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-ccm'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-cfb'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-cfb1'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-cfb8'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-ctr'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-ecb'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-gcm'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-ocb'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-ofb'</span><span class="token punctuation">,</span> <span class="token string">'aes-128-xts'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-cbc'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-ccm'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-cfb'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-cfb1'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-cfb8'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-ctr'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-ecb'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-gcm'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-ocb'</span><span class="token punctuation">,</span> <span class="token string">'aes-192-ofb'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-cbc'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-cbc-hmac-sha1'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-cbc-hmac-sha256'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-ccm'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-cfb'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-cfb1'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-cfb8'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-ctr'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-ecb'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-gcm'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-ocb'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-ofb'</span><span class="token punctuation">,</span> <span class="token string">'aes-256-xts'</span><span class="token punctuation">,</span> <span class="token string">'aes128'</span><span class="token punctuation">,</span> <span class="token string">'aes128-wrap'</span><span class="token punctuation">,</span> <span class="token string">'aes192'</span><span class="token punctuation">,</span> <span class="token string">'aes192-wrap'</span><span class="token punctuation">,</span> <span class="token string">'aes256'</span><span class="token punctuation">,</span> <span class="token string">'aes256-wrap'</span><span class="token punctuation">,</span> <span class="token string">'bf'</span><span class="token punctuation">,</span> <span class="token string">'bf-cbc'</span><span class="token punctuation">,</span> <span class="token string">'bf-cfb'</span><span class="token punctuation">,</span> <span class="token string">'bf-ecb'</span><span class="token punctuation">,</span> <span class="token string">'bf-ofb'</span><span class="token punctuation">,</span> <span class="token string">'blowfish'</span><span class="token punctuation">,</span> <span class="token string">'des'</span><span class="token punctuation">,</span> <span class="token string">'des-cbc'</span><span class="token punctuation">,</span><span class="token string">'des-cfb'</span><span class="token punctuation">,</span> <span class="token string">'des-cfb1'</span><span class="token punctuation">,</span> <span class="token string">'des-cfb8'</span><span class="token punctuation">,</span> <span class="token string">'des-ecb'</span><span class="token punctuation">,</span> <span class="token string">'des3'</span><span class="token punctuation">,</span><span class="token operator">...</span> <span class="token number">39</span> more items
</code></pre></div><h4 id="常见的加密基本概念"><a href="#常见的加密基本概念" class="header-anchor">#</a> 常见的加密基本概念</h4> <div class="language-markdown extra-class"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">###</span> AES加密</span>
高级加密标准（英语：Advanced Encryption Standard，缩写：AES），在密码学中又称Rijndael加密法，是美国联邦政府采用的一种区块加密标准。这个标准用来替代原先的DES，已经被多方分析且广为全世界所使用。经过五年的甄选流程，高级加密标准由美国国家标准与技术研究院（NIST）于2001年11月26日发布于FIPS PUB 197，并在2002年5月26日成为有效的标准。2006年，高级加密标准已然成为对称密钥加密中最流行的算法之一。

AES使用的秘钥长度可以128位、192位或256位，所以通常看到的加密算法：aes-128/196/256，表示的都是秘钥的位数。而最后的一段是AES的工作模式，最常用的工作模式是ECB、CBC、CFB和OFB四种。
  <span class="token list punctuation">1.</span> ECB（电子密码本模式：Electronic codebook）是最简单的块密码加密模式，加密前根据加密块大小（如AES为128位）分成若干块，之后将每块使用相同的密钥单独加密，解密同理。ECB模式由于每块数据的加密是独立的因此加密和解密都可以并行计算，ECB模式最大的缺点是相同的明文块会被加密成相同的密文块，这种方法在某些环境下不能提供严格的数据保密性。
  <span class="token list punctuation">2.</span> CBC模式对于每个待加密的密码块在加密前会先与前一个密码块的密文异或然后再用加密器加密。第一个明文块与一个叫初始化向量的数据块异或。CBC模式相比ECB有更高的保密性，但由于对每个数据块的加密依赖与前一个数据块的加密所以加密无法并行。与ECB一样在加密前需要对数据进行填充，不是很适合对流数据进行加密。
  <span class="token list punctuation">3.</span> 与ECB和CBC模式只能够加密块数据不同，CFB(密文反馈:Cipher feedback)能够将块密文（Block Cipher）转换为流密文（Stream Cipher）。
  <span class="token list punctuation">4.</span> OFB（输出反馈：Output feedback）是先用块加密器生成密钥流（Keystream），然后再将密钥流与明文流异或得到密文流，解密是先用块加密器生成密钥流，再将密钥流与密文流异或得到明文，由于异或操作的对称性所以加密和解密的流程是完全一样的。
  <span class="token list punctuation">5.</span> GCM可以提供对消息的加密和完整性校验，另外，它还可以提供附加消息的完整性校验。在实际应用场景中，有些信息是我们不需要保密，但信息的接收者需要确认它的真实性的，例如源IP，源端口，目的IP，IV，等等。因此，我们可以将这一部分作为附加消息加入到MAC值的计算当中。下图的Ek表示用对称秘钥k对输入做AES运算。最后，密文接收者会收到密文、IV（计数器CTR的初始值）、MAC值。
 
<span class="token title important"><span class="token punctuation">###</span> DES加密</span>
des对称加密，是一种比较传统的加密方式，其加密运算、解密运算使用的是同样的密钥，信息的发送者和信息的接收者在进行信息的传输与处理时，必须共同持有该密码（称为对称密码），是一种对称加密算法。

DES使用一个56位的密钥以及附加的8位奇偶校验位，产生最大64位的分组大小。所以正常我们给DES加密的时候都是传递56位秘钥即可。同样DES也有几种工作模式：DES、ECB、CBC，工作模式基本和上面的一致。
</code></pre></div><h4 id="aes-256-gcm-示例"><a href="#aes-256-gcm-示例" class="header-anchor">#</a> AES-256-GCM 示例</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 初始化参数</span>
<span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token string">'Encryption Testing AES GCM mode'</span><span class="token punctuation">;</span> <span class="token comment">// 要加密和解密的数据</span>
<span class="token keyword">const</span> key <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 256 位的共享密钥</span>
<span class="token keyword">const</span> iv <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">randomBytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始向量(加工密匙)，16 字节</span>
<span class="token keyword">const</span> algorithm <span class="token operator">=</span> <span class="token string">'aes-256-gcm'</span><span class="token punctuation">;</span> <span class="token comment">// 加密算法和操作模式</span>

<span class="token comment">// 加密</span>
<span class="token keyword">const</span> cipher <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createCipheriv</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化加密算法</span>
<span class="token keyword">let</span> encrypted <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">,</span> <span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 进行加密+</span>
encrypted <span class="token operator">+=</span> cipher<span class="token punctuation">.</span><span class="token function">final</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 加入剩余内容</span>
<span class="token keyword">const</span> tag <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">getAuthTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 生成标签，用于验证密文的来源</span>

<span class="token comment">// 解密</span>
<span class="token keyword">const</span> decipher <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createDecipheriv</span><span class="token punctuation">(</span>algorithm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始化解密算法</span>
decipher<span class="token punctuation">.</span><span class="token function">setAuthTag</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 传入验证标签，验证密文的来源</span>
<span class="token keyword">let</span> decrypted <span class="token operator">=</span> decipher<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>encrypted<span class="token punctuation">,</span> <span class="token string">'hex'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 进行解密</span>
decrypted <span class="token operator">+=</span> decipher<span class="token punctuation">.</span><span class="token function">final</span><span class="token punctuation">(</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 加入剩余内容</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>decrypted<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Encryption Testing AES GCM mode</span>
</code></pre></div><h3 id="非对称加密-rea密匙"><a href="#非对称加密-rea密匙" class="header-anchor">#</a> 非对称加密 (REA密匙)</h3> <p>非对称加密算法需要两个密钥：公开密钥（publickey:简称公钥）和私有密钥（privatekey:简称私钥）。非对称密码体制的特点：算法强度复杂、安全性依赖于算法与密钥但是由于其算法复杂，而使得加密解密速度没有对称加密解密的速度快。对称密码体制中只有一种密钥，并且是非公开的，如果要解密就得让对方知道密钥。</p> <h4 id="生成-rsa-密匙对"><a href="#生成-rsa-密匙对" class="header-anchor">#</a> 生成 RSA 密匙对</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> generateKeyPair<span class="token punctuation">,</span> generateKeyPairSync <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">generateKeyPair</span><span class="token punctuation">(</span><span class="token string">'rsa'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// 算法名称 必须是 rsa / dsa / ec 之一</span>
  modulusLength<span class="token operator">:</span> <span class="token number">4096</span><span class="token punctuation">,</span> <span class="token comment">// 密匙长度</span>
  publicKeyEncoding<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 公钥编码格式</span>
    type<span class="token operator">:</span> <span class="token string">'spki'</span><span class="token punctuation">,</span> <span class="token comment">// pkcs1、spki</span>
    format<span class="token operator">:</span> <span class="token string">'pem'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  privateKeyEncoding<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 私钥编码格式</span>
    type<span class="token operator">:</span> <span class="token string">'pkcs8'</span><span class="token punctuation">,</span> <span class="token comment">// 私钥输出格式 必须是 pkcs1 / pkcs8 / sec1 之一</span>
    format<span class="token operator">:</span> <span class="token string">'pem'</span><span class="token punctuation">,</span> <span class="token comment">// 私钥输出格式 必须是 pem / der 之一</span>
    cipher<span class="token operator">:</span> <span class="token string">'aes-256-cbc'</span><span class="token punctuation">,</span> <span class="token comment">// 对私钥使用 aes-256-cbc 算法加密后返回</span>
    passphrase<span class="token operator">:</span> <span class="token string">'top secret'</span> <span class="token comment">// aes-256-cbc 算法密钥</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> privateKey</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建文件保存密匙对....</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 同步方法</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> privateKey<span class="token punctuation">,</span> publicKey <span class="token punctuation">}</span> <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">generateKeyPairSync</span><span class="token punctuation">(</span><span class="token string">'ec'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="公钥加密-私钥解密"><a href="#公钥加密-私钥解密" class="header-anchor">#</a> 公钥加密 / 私钥解密</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 读取密匙对</span>
<span class="token keyword">const</span> publicKey <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/mypubkey.pem'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> privateKey <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/ mykey.pem'</span><span class="token punctuation">)</span>
<span class="token comment">// 需要加密的内容</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token string">'data to crypt'</span><span class="token punctuation">;</span>
<span class="token comment">// 公钥加密</span>
<span class="token keyword">const</span> encryptData <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">publicEncrypt</span><span class="token punctuation">(</span>publicKey<span class="token punctuation">,</span> Buffer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'encode'</span><span class="token punctuation">,</span> encryptData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 私钥解密</span>
<span class="token keyword">const</span> decryptData <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">privateDecrypt</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">,</span> encryptData<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'decode'</span><span class="token punctuation">,</span> decryptData<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="sign-verify-签名与验证"><a href="#sign-verify-签名与验证" class="header-anchor">#</a> Sign / Verify (签名与验证)</h3> <p>Sign签名存在目的是为了防止不法分子修改参数数据，进而攻击服务器，导致数据泄露或从中获得利益。例如：一个接口是用户把积分转帐给他的朋友，修改后，变为转帐到攻击者的帐户，这样，攻击者就能得到利益。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入REA密匙生成器, 创建签名函数, 验证签名函数</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> generateKeyPairSync<span class="token punctuation">,</span> createSign<span class="token punctuation">,</span> createVerify <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span>
<span class="token comment">// 生成REA密匙</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> publicKey<span class="token punctuation">,</span> privateKey <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">generateKeyPairSync</span><span class="token punctuation">(</span><span class="token string">'rsa'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> modulusLength<span class="token operator">:</span> <span class="token number">4096</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">// 密匙长度4096</span>
<span class="token comment">// 私钥生成签名</span>
<span class="token keyword">const</span> sign <span class="token operator">=</span> <span class="token function">createSign</span><span class="token punctuation">(</span><span class="token string">'SHA256'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sign<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">'签名内容'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> sign_buf <span class="token operator">=</span> sign<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 公钥验证签名</span>
<span class="token keyword">const</span> verify <span class="token operator">=</span> <span class="token function">createVerify</span><span class="token punctuation">(</span><span class="token string">'SHA256'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
verify<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token string">'签名内容'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>verify<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>publicKey<span class="token punctuation">,</span> sign_buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="dh-密钥交换"><a href="#dh-密钥交换" class="header-anchor">#</a> DH 密钥交换</h3> <p>DH密钥交换是1976年由Diffie和Hellman共同发明的一种算法。使用这种算法，通信双方仅通过交换一些可以公开的信息就能够生成出共享的密码数字，而这一密码数字就可以被用作对称密码的密钥。IPsec中就使用了经过改良的DH密钥交换。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Generate(生成) Alice's keys...</span>
<span class="token comment">// 创建客户端的DH实例, 素数长度为1024</span>
<span class="token keyword">const</span> alice <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createDiffieHellman</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 产生公/私钥对, Ya = a^Xa mod p</span>
<span class="token keyword">const</span> aliceKey <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">generateKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Generate(生成) Bob's keys...</span>
<span class="token comment">// 创建客户端的DH实例, 采用跟客户端相同的素数</span>
<span class="token keyword">const</span> bob <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createDiffieHellman</span><span class="token punctuation">(</span>alice<span class="token punctuation">.</span><span class="token function">getPrime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alice<span class="token punctuation">.</span><span class="token function">getGenerator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 产生公/私钥对, Ya = a^Xa mod p</span>
<span class="token keyword">const</span> bobKey <span class="token operator">=</span> bob<span class="token punctuation">.</span><span class="token function">generateKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 交换并生成密匙...</span>
<span class="token comment">// 计算 Ka = Yb^Xa mod p</span>
<span class="token keyword">const</span> aliceSecret <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">computeSecret</span><span class="token punctuation">(</span>bobKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 计算 Kb = Ya^Xb mod p</span>
<span class="token keyword">const</span> bobSecret <span class="token operator">=</span> bob<span class="token punctuation">.</span><span class="token function">computeSecret</span><span class="token punctuation">(</span>aliceKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 由于素数p是动态生成的，所以每次打印都不一样</span>
<span class="token comment">// 但是 clientSecret === serverSecret</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>aliceSecret <span class="token operator">===</span> bobSecret<span class="token punctuation">)</span>
</code></pre></div><h3 id="ecdh-密钥交换"><a href="#ecdh-密钥交换" class="header-anchor">#</a> ECDH 密钥交换</h3> <p><code>ECDH</code> 类是创建椭圆曲线 Diffie-Hellman（Elliptic Curve Diffie-Hellman (ECDH)）键交换的实用工具。 <code>ECDH</code> 类的实例可以使用 <code>crypto.createECDH()</code> 方法。。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Generate(生成) Alice's keys...</span>
<span class="token keyword">const</span> alice <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createECDH</span><span class="token punctuation">(</span><span class="token string">'secp521r1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> aliceKey <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">generateKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Generate(生成) Bob's keys...</span>
<span class="token keyword">const</span> bob <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createECDH</span><span class="token punctuation">(</span><span class="token string">'secp521r1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bobKey <span class="token operator">=</span> bob<span class="token punctuation">.</span><span class="token function">generateKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 交换并生成密匙...</span>
<span class="token comment">// 计算 Ka = Yb^Xa mod p</span>
<span class="token keyword">const</span> aliceSecret <span class="token operator">=</span> alice<span class="token punctuation">.</span><span class="token function">computeSecret</span><span class="token punctuation">(</span>bobKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 计算 Kb = Ya^Xb mod p</span>
<span class="token keyword">const</span> bobSecret <span class="token operator">=</span> bob<span class="token punctuation">.</span><span class="token function">computeSecret</span><span class="token punctuation">(</span>aliceKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>aliceSecret <span class="token operator">===</span> bobSecret<span class="token punctuation">)</span>
</code></pre></div></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/04-mongodb-cha-xun-yu-geng-xin-cao-zuo-fu.html" class="prev">
            mongodb 查询与更新操作符
          </a></span> <span class="next"><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/06-express-webfu-wu-kai-fa.html">
            Express Web服务开发
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-70334359><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#node-基础知识补充" class="sidebar-link reco-side-node-基础知识补充" data-v-70334359>Node 基础知识补充</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#cmd基本知识" class="sidebar-link reco-side-cmd基本知识" data-v-70334359>CMD基本知识</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#环境变量-window系统中的变量" class="sidebar-link reco-side-环境变量-window系统中的变量" data-v-70334359>环境变量（window系统中的变量 ）</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#进程和线程" class="sidebar-link reco-side-进程和线程" data-v-70334359>进程和线程</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#node-js-概念" class="sidebar-link reco-side-node-js-概念" data-v-70334359>Node.js 概念</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#node的用途" class="sidebar-link reco-side-node的用途" data-v-70334359>Node的用途</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#i-o-input-output" class="sidebar-link reco-side-i-o-input-output" data-v-70334359>I/O (Input/Output)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#node语言是js模型" class="sidebar-link reco-side-node语言是js模型" data-v-70334359>Node语言是JS模型</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#node中使用的内建对象" class="sidebar-link reco-side-node中使用的内建对象" data-v-70334359>Node中使用的内建对象</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#ecmascript标准的缺陷" class="sidebar-link reco-side-ecmascript标准的缺陷" data-v-70334359>ECMAScript标准的缺陷</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#模块化-require" class="sidebar-link reco-side-模块化-require" data-v-70334359>模块化（require）</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#模块标识" class="sidebar-link reco-side-模块标识" data-v-70334359>模块标识</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#核心模块" class="sidebar-link reco-side-核心模块" data-v-70334359>核心模块</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#文件模块" class="sidebar-link reco-side-文件模块" data-v-70334359>文件模块</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#模块定义" class="sidebar-link reco-side-模块定义" data-v-70334359>模块定义</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#模块引用" class="sidebar-link reco-side-模块引用" data-v-70334359>模块引用</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#模块实例" class="sidebar-link reco-side-模块实例" data-v-70334359>模块实例</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#全局对象-global" class="sidebar-link reco-side-全局对象-global" data-v-70334359>全局对象（global）</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#exports-和-module-exports" class="sidebar-link reco-side-exports-和-module-exports" data-v-70334359>exports 和 module.exports</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#模块包-package" class="sidebar-link reco-side-模块包-package" data-v-70334359>模块包（package）</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#引入包和使用包" class="sidebar-link reco-side-引入包和使用包" data-v-70334359>引入包和使用包</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#缓冲区-buffer" class="sidebar-link reco-side-缓冲区-buffer" data-v-70334359>缓冲区（Buffer）</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#bufferapi-方法" class="sidebar-link reco-side-bufferapi-方法" data-v-70334359>BufferApi 方法</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#bufferapi实例" class="sidebar-link reco-side-bufferapi实例" data-v-70334359>BufferApi实例</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#文件系统-fs" class="sidebar-link reco-side-文件系统-fs" data-v-70334359>文件系统（fs）</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#打开-关闭文件" class="sidebar-link reco-side-打开-关闭文件" data-v-70334359>打开&amp;关闭文件</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#写入文件" class="sidebar-link reco-side-写入文件" data-v-70334359>写入文件</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#读取文件" class="sidebar-link reco-side-读取文件" data-v-70334359>读取文件</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#其他操作" class="sidebar-link reco-side-其他操作" data-v-70334359>其他操作</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#路径系统-path" class="sidebar-link reco-side-路径系统-path" data-v-70334359>路径系统 (path)</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#操作系统-os" class="sidebar-link reco-side-操作系统-os" data-v-70334359>操作系统 (os)</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#地址解析系统-url" class="sidebar-link reco-side-地址解析系统-url" data-v-70334359>地址解析系统 (url)</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#服务器系统-http-https" class="sidebar-link reco-side-服务器系统-http-https" data-v-70334359>服务器系统 (http|https)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#开启本地服务器的基本流程" class="sidebar-link reco-side-开启本地服务器的基本流程" data-v-70334359>开启本地服务器的基本流程</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#req-请求-携带的常用参数" class="sidebar-link reco-side-req-请求-携带的常用参数" data-v-70334359>req (请求) 携带的常用参数</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#req-响应-携带的常用参数" class="sidebar-link reco-side-req-响应-携带的常用参数" data-v-70334359>req (响应) 携带的常用参数</a></li><li class="level-2" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#加密系统-crypto" class="sidebar-link reco-side-加密系统-crypto" data-v-70334359>加密系统 (crypto)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#hash-加密-sha-256" class="sidebar-link reco-side-hash-加密-sha-256" data-v-70334359>hash 加密(SHA-256)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#pbkdf2-加密-sha256" class="sidebar-link reco-side-pbkdf2-加密-sha256" data-v-70334359>PBKDF2 加密(sha256)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#salt-盐值加密-md5" class="sidebar-link reco-side-salt-盐值加密-md5" data-v-70334359>salt 盐值加密(md5)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#hmac-加密-sha1" class="sidebar-link reco-side-hmac-加密-sha1" data-v-70334359>Hmac 加密(sha1)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#cipher-加密-和-decipher-解密" class="sidebar-link reco-side-cipher-加密-和-decipher-解密" data-v-70334359>Cipher (加密) 和 Decipher (解密)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#非对称加密-rea密匙" class="sidebar-link reco-side-非对称加密-rea密匙" data-v-70334359>非对称加密 (REA密匙)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#sign-verify-签名与验证" class="sidebar-link reco-side-sign-verify-签名与验证" data-v-70334359>Sign / Verify (签名与验证)</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#dh-密钥交换" class="sidebar-link reco-side-dh-密钥交换" data-v-70334359>DH 密钥交换</a></li><li class="level-3" data-v-70334359><a href="/mao-blog/ruan-jian-kai-fa/hou-duan-bi-ji/05-nodejs-fu-wu-duan-cv8kuang-jia.html#ecdh-密钥交换" class="sidebar-link reco-side-ecdh-密钥交换" data-v-70334359>ECDH 密钥交换</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><APlayer audio="" fixed="true" mini="true" autoplay="autoplay" theme="#b7daff" loop="loop" order="random" preload="auto" volume="0.15" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer><div></div><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;right:65px;bottom:-55px;width:135px;height:300px;z-index:99999;opacity:0.8;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div></div></div>
    <script src="/mao-blog/assets/js/app.19e1b50c.js" defer></script><script src="/mao-blog/assets/js/4.512e8a4d.js" defer></script><script src="/mao-blog/assets/js/1.6b005ada.js" defer></script><script src="/mao-blog/assets/js/29.c4272f05.js" defer></script>
  </body>
</html>
