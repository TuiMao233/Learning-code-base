# vue-cli基础架构

## Vue脚手架 入口函数src/main.js配置

~~~javascript
/* src/main.js */
import Vue from 'vue'     	 //创建vue实例
import App from './App.vue'  //引入主要组件
var vm = new Vue({
 	el: '#app',				//选择ID为app的元素
	components: {App},		//映射组件为标签
 	 template: '<App />'		//app元素内部添加映射标签<App />
})
~~~

## vue 组件的定义和使用

### 组件模块方式（App.vue）

~~~html
<!-- 模板页面(内容必须用div包裹) -->
<template>
	<div></div>
</template>
<!-- JS 模块对象 -->
<script>
	export default {
		data() {return {}},
		methods: {},
		…………
	}
</script>
<!-- 样式定义 -->
<style>
</style>
~~~

### App.vue引入其他组件使用方式

~~~html
	<template>
	<HelloWorld></HelloWorld>		<!-- 3- 使用组件标签 -->	
	<hello-world />					<!-- 3- 使用组件标签 -->
	</template>
	<script>
	import HelloWorld from './components/HelloWorld'     /* 1- 引入组件 */
	export default {
	components: {
		HelloWorld        /* 2- 映射成标签 */
		}
	}
	</script>
~~~

# 组件间标签传输

### 利用标签名从父组件传输数据到子组件

~~~html
<!-- 父组件标签(App.js)传输数据(任意JS属性或方法) -->
<TdoHead  :addTask='addTask' /> 
~~~

~~~html
<!--  子组件(components/...js)props接收数据  -->
<script>
 const vm = new Vue({
     props: { addTask: Function }
 })
</script>
~~~

### 利用自定义标签从父组件标签直接传输数据到子组件

~~~html
<!-- 父组件标签(App.js)传输数据(任意JS属性或方法) -->
<TdoHead  @addTask='addTask' /> 
~~~

~~~javascript
/* 子组件(components/...js)利用$emit方法接收(?)或使用数据 */
     methods: {
      sumTask () { 
		// 使用自定义事件,this.$emit('事件名', [,传入的形参])
         this.$emit('addTask', task)
      }
 	}
~~~

### 父组件传子组件（自定义标签事件）

~~~html
<TdoHead  @addTask='addTask' /> 
<script>
  /* 父组件异步传输数据 */
mounted () { // 给<TdoHead>添加名为addTask的事件 并传入数据(方法)
      this.$refs.header.$on('addTask', this.addTask)
}
</script>
~~~

~~~javascript
/* 子组件(components/...js)利用$emit方法接收(?)或使用数据 */
methods: {
	sumTask () {
		//使用自定义事件,this.$emit('事件名', [,传入的形参])
		this.$emit('addTask', task)
	}
}
~~~

# Vue消息订阅发布

### 项目安装 pubsub 消息系统（信息中介）

~~~
npm install –save pubsub-js   -->安装
npm info pubsub-js	-->查看信息
~~~

### Vue组件引入并使用pubsub

**pubsub可在Vue组件任意地方传输数据**

**引入 pubsub** 

~~~javascript
import PubSub from 'pubsub-js'
~~~

**发布消息**`任意组件发布消息数据`

~~~javascript
// data 任何js属性或方法
PubSub.publish('消息名', data)
~~~

**订阅消息**`任意组件订阅消息数据`

~~~javascript
// PubSub.subscribe 当publish方法调用并消息名一致时执行
PubSub.subscribe('消息名', function(msg, data){
	console.log(data)
})
~~~



# 组件间slot标签传输

#### 一、父组件利用子组件标签传入实体标签

~~~html
<!-- 传入子组件需要的标签 -->
<子组件标签> 
	<div slot="xxx">xxx 对应的标签结构</div>
	<div slot="yyy">yyy 对应的标签结构</div>
</子组件标签> 
~~~

#### 二、子组件使用父组件传入的标签输出标签

~~~html
<!-- 输出父组件标签 -->
<div>
	<slot name="xxx">父组件对应xxx的标签结构</slot>
	<div>组件确定的标签结构</div>
	<slot name="yyy">父组件对应yyy的标签结构</slot>
</div>
~~~

#### Vue-ajax与vue-resource的安装与使用

~~~
/* 安装vue-resource */
cnpm install vue-resource --save
/* 安装axios */
cnpm install axios --save
~~~

#### 一、vue-axios使用：

- ~~~javascript
  // 在需要使用的组件内引入axios
  import axios from 'axios'
  // 使用axios发送ajax请求获取数据
  axios.get(url).then(axioData => {
      console.log(axioData.data)
  }).catch(axioErrorData => {
      console.log(axioErrorData.data)
  })
  ~~~


#### 二、vue-resource使用：

- ```javascript
  /* Main.js入口函数设置 */
  import Vue from 'vue'
  import App from './App.vue'
  import VueRouter from 'vue-resource' 
  Vue.use(VueRouter)
  var vm = new Vue({ el: '#app', components: { App }, template: '<App/>' })
  ```

- ```javascript
  /* App.vue实例中使用  */
  mounted () { 
      // 入口函数设置后Vue实例会自带一个$http对象
  	this.$http.get(url).then(
     		// 获取成功则调用这个函数
     		resourData => { console.log(axioData.data) },
     		// 获取失败则调用这个函数
     		resourErrorData => { console.log(resourErrorData.data) }
  	)
  }
  ```

